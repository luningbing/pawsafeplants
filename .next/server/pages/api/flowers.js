"use strict";(()=>{var e={};e.id=4068,e.ids=[4068],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},8313:(e,t,s)=>{s.r(t),s.d(t,{config:()=>y,default:()=>d,routeModule:()=>m});var a={};s.r(a),s.d(a,{default:()=>u});var o=s(1802),r=s(7153),n=s(6249),i=s(2885);let l=process.env.SUPABASE_URL||"",c=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SUPABASE_ANON_KEY||"";l&&c||console.warn("Missing Supabase credentials for flower detail API");let f=l&&c?(0,i.createClient)(l,c):null;async function u(e,t){try{if(t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),t.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization"),"OPTIONS"===e.method)return t.status(200).end();if("GET"===e.method){let{slug:s,category:a,safety_status:o,occasion:r}=e.query;if(s)try{let e=null;if(f){let{data:t,error:a}=await f.rpc("get_flower_by_slug",{flower_slug:s});if(!a&&t&&t.length>0)e=t[0];else{let{data:t,error:a}=await f.from("media_metadata").select("*").eq("seo_slug",s).eq("category","flower").single();!a&&t&&(e=t)}}if(e)return t.status(200).json({success:!0,flower:e,seo:{title:`${e.display_name} - Is it a Cat Safe Flower? | PawSafePlants`,description:`${e.display_name} ${"Safe"===e.safety_status?"is completely safe for cats":"may be harmful to cats"}. ${e.toxicity_level}. ${e.search_intent?.join(", ")||"Cat safety information"}.`,keywords:`${e.common_name}, ${e.scientific_name}, ${e.search_intent?.join(", ")||""}, cat safe flowers, pet friendly flowers, ${e.safety_status.toLowerCase()} flowers for cats`,canonical:`https://www.pawsafeplants.com/plants/${e.seo_slug}`}});return t.status(404).json({success:!1,error:"Flower not found"})}catch(a){console.error("Error fetching flower:",a);let e={"peony-toxicity-cats":{id:1,common_name:"Peony",scientific_name:"Paeonia lactiflora",family:"Paeoniaceae",display_name:"Peony",safety_status:"Toxic",toxicity_level:"Toxic – Can cause gastrointestinal upset",toxicity_symptoms:"Vomiting, diarrhea, drooling, abdominal pain",gifting_occasions:["Wedding","Anniversary","Birthday"],search_intent:["Peony bouquet delivery","Are peonies safe?"],seo_slug:"peony-toxicity-cats",file_path:"https://images.unsplash.com/photo-1558628037-f3b6c1b0c3b2?w=400&h=400&fit=crop"},"cat-safe-roses":{id:3,common_name:"Rose",scientific_name:"Rosa rubiginosa",family:"Rosaceae",display_name:"Rose",safety_status:"Safe",toxicity_level:"Safe – Generally non-toxic to cats",toxicity_symptoms:"None (thorns may cause physical injury)",gifting_occasions:["Valentine's Day","Anniversary","Birthday","Wedding"],search_intent:["Classic romance","Cat safe roses"],seo_slug:"cat-safe-roses",file_path:"https://images.unsplash.com/photo-1518709594023-a7b5d2e4cf76?w=400&h=400&fit=crop"},"lily-deadly-toxicity-cats":{id:11,common_name:"Lily",scientific_name:"Lilium longiflorum",family:"Liliaceae",display_name:"Lily",safety_status:"Deadly",toxicity_level:"Deadly – Extremely toxic, can cause acute kidney failure",toxicity_symptoms:"Vomiting, lethargy, loss of appetite, kidney failure, death",gifting_occasions:["Easter","Wedding","Funeral"],search_intent:["Easter Lily danger","Lily pollen cat death"],seo_slug:"lily-deadly-toxicity-cats",file_path:"https://images.unsplash.com/photo-1598306948263-8e4b4898d6b5?w=400&h=400&fit=crop"}}[s]||null;if(e)return t.status(200).json({success:!0,flower:e,seo:{title:`${e.display_name} - Is it a Cat Safe Flower? | PawSafePlants`,description:`${e.display_name} ${"Safe"===e.safety_status?"is completely safe for cats":"may be harmful to cats"}. ${e.toxicity_level}. ${e.search_intent?.join(", ")||"Cat safety information"}.`,keywords:`${e.common_name}, ${e.scientific_name}, ${e.search_intent?.join(", ")||""}, cat safe flowers, pet friendly flowers, ${e.safety_status.toLowerCase()} flowers for cats`,canonical:`https://www.pawsafeplants.com/plants/${e.seo_slug}`}});return t.status(404).json({success:!1,error:"Flower not found"})}else if("flower"===a)try{let e=[];if(f){let{data:t,error:s}=await f.from("media_metadata").select("*").eq("category","flower").order("priority_rank",{ascending:!0});!s&&t&&(e=t)}return t.status(200).json({success:!0,flowers:e,total:e.length,category:"flower"})}catch(e){return console.error("Error fetching flowers by category:",e),t.status(500).json({success:!1,error:"Failed to fetch flowers"})}else if(o)try{let e=[];if(f){let{data:t,error:s}=await f.from("media_metadata").select("*").eq("category","flower").eq("safety_status",o).order("priority_rank",{ascending:!0});!s&&t&&(e=t)}return t.status(200).json({success:!0,flowers:e,safety_status:o,total:e.length})}catch(e){return console.error("Error fetching flowers by safety status:",e),t.status(500).json({success:!1,error:"Failed to fetch flowers"})}else if(r)try{let e=[];if(f){let{data:t,error:s}=await f.from("media_metadata").select("*").eq("category","flower").contains("gifting_occasions",r).order("priority_rank",{ascending:!0});!s&&t&&(e=t)}return t.status(200).json({success:!0,flowers:e,occasion:r,total:e.length})}catch(e){return console.error("Error fetching flowers by occasion:",e),t.status(500).json({success:!1,error:"Failed to fetch flowers"})}else try{let e=[];if(f){let{data:t,error:s}=await f.from("media_metadata").select("*").eq("category","flower").order("priority_rank",{ascending:!0});!s&&t&&(e=t)}return t.status(200).json({success:!0,flowers:e,total:e.length})}catch(e){return console.error("Error fetching all flowers:",e),t.status(500).json({success:!1,error:"Failed to fetch flowers"})}}return t.status(405).json({success:!1,error:"Method not allowed"})}catch(e){return console.error("Unexpected error in flower detail API:",e),t.status(500).json({success:!1,error:"Internal server error",message:e.message})}}let d=(0,n.l)(a,"default"),y=(0,n.l)(a,"config"),m=new o.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/flowers",pathname:"/api/flowers",bundlePath:"",filename:""},userland:a})},7153:(e,t)=>{var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},1802:(e,t,s)=>{e.exports=s(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var s=t(t.s=8313);module.exports=s})();