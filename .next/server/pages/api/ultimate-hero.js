"use strict";(()=>{var e={};e.id=2510,e.ids=[2510],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},3844:(e,t,r)=>{r.r(t),r.d(t,{config:()=>p,default:()=>f,routeModule:()=>m});var o={};r.r(o),r.d(o,{default:()=>g});var s=r(1802),a=r(7153),l=r(6249),i=r(7147),n=r.n(i),d=r(1017),u=r.n(d),c=r(2885);async function g(e,t){try{console.log("Ultimate Hero API called:",e.method);let r=u().join(process.cwd(),"content","settings"),o=u().join(r,"hero.json");if(n().existsSync(r)||(console.log("Creating settings directory:",r),n().mkdirSync(r,{recursive:!0})),"GET"===e.method){console.log("Reading ultimate hero carousel data"),console.log("Supabase URL:",process.env.SUPABASE_URL),console.log("Supabase Key exists:",!!process.env.SUPABASE_SERVICE_ROLE_KEY);try{let e=process.env.SUPABASE_URL||"",r=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SUPABASE_ANON_KEY||"";if(e&&r){console.log("Reading from Supabase database");let s=(0,c.createClient)(e,r),{data:a,error:l}=await s.from("hero_carousel").select("*").order("created_at",{ascending:!1}).limit(1);if(console.log("Supabase response:",{data:a,error:l}),l)console.error("Database read error:",l);else if(a&&a.length>0){let e=a[0].content;if(console.log("Found hero data in database:",e),e.slides&&Array.isArray(e.slides)&&e.slides.length>=3){console.log("Processing slides:",e.slides);let r={slides:e.slides.slice(0,3).map(e=>({imageUrl:e.imageUrl,title:e.title,subtitle:e.subtitle,link:e.link||"/plants/safe"})),updatedAt:new Date().toISOString()};console.log("Ultimate data prepared:",r);try{n().writeFileSync(o,JSON.stringify(r,null,2)),console.log("Saved existing data to ultimate-hero.json")}catch(e){console.error("Error writing ultimate hero file:",e)}return t.status(200).json(r)}console.log("Invalid slides data in database")}else console.log("No data found in database")}else console.log("Missing Supabase credentials")}catch(e){console.error("Database connection error:",e)}try{if(n().existsSync(o)){console.log("Reading from ultimate hero file:",o);let e=n().readFileSync(o,"utf8"),r=JSON.parse(e);if(r.slides&&Array.isArray(r.slides)&&3===r.slides.length)return console.log("Using saved ultimate hero data:",r),t.status(200).json(r)}}catch(e){console.error("Error reading ultimate hero file:",e)}let e={slides:[{imageUrl:"/uploads/20250530-190020.jpg",title:"Cat-Safe Plants for Your Home",subtitle:"Create a beautiful, pet-friendly living space",link:"/plants/safe"},{imageUrl:"/uploads/_247026d4-f09b-4307-9d55-65b40bd2813c.jpg",title:"Toxic Plants to Avoid",subtitle:"Protect your feline friends from harmful plants",link:"/plants/toxic"},{imageUrl:"/uploads/7ae0aff1-4b60-4c05-aa34-fcd6a9ea3dd2_7930717a90c33c714f1ae8d742554593_ComfyUI_033fc57d_00001_.png",title:"Plant Care Guide",subtitle:"Learn how to care for your green companions",link:"/plants/caution"}],updatedAt:new Date().toISOString()};return console.log("Using default data with existing image paths"),t.status(200).json(e)}if("POST"===e.method){console.log("Saving ultimate hero carousel data");let{slides:r}=e.body;if(console.log("Received slides:",r),!r||!Array.isArray(r)||3!==r.length)return console.error("Invalid slides data - must have exactly 3 slides"),t.status(400).json({error:"必须提供3张轮播图数据"});for(let e=0;e<3;e++){let o=r[e];if(!o.imageUrl||!o.title||!o.subtitle)return t.status(400).json({error:`第${e+1}张轮播图缺少必需字段 (imageUrl, title, subtitle)`})}let s={slides:r,updatedAt:new Date().toISOString()};console.log("Writing ultimate hero data to file:",o);try{n().writeFileSync(o,JSON.stringify(s,null,2)),console.log("Ultimate hero data saved successfully")}catch(e){return console.error("Error writing hero file:",e),t.status(500).json({error:"保存失败: "+e.message})}return t.status(200).json(s)}return t.status(405).json({error:"Method not allowed"})}catch(e){return console.error("Ultimate Hero API error:",e),t.status(500).json({error:"Internal server error: "+e.message})}}let f=(0,l.l)(o,"default"),p=(0,l.l)(o,"config"),m=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/ultimate-hero",pathname:"/api/ultimate-hero",bundlePath:"",filename:""},userland:o})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=3844);module.exports=r})();