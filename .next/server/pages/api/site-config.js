"use strict";(()=>{var e={};e.id=4707,e.ids=[4707],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},4359:(e,t,r)=>{r.r(t),r.d(t,{config:()=>m,default:()=>f,routeModule:()=>S});var o={};r.r(o),r.d(o,{default:()=>p});var n=r(1802),i=r(7153),a=r(6249),s=r(7147),l=r.n(s),u=r(1017),c=r.n(u),g=r(2885);async function p(e,t){try{let r=c().join(process.cwd(),"content","site.json");if("GET"===e.method){let e=process.env.SUPABASE_URL||"",o=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SUPABASE_ANON_KEY||"";if(e&&o){let r=(0,g.createClient)(e,o),{data:n,error:i}=await r.from("site_config").select("key,value").in("key",["heroImage","logo"]);if(!i){let e=Object.create(null)(n||[]).forEach(t=>{e[t.key]=t.value});return t.status(200).json({heroImage:String(e.heroImage||"").trim(),logo:String(e.logo||"").trim()})}}try{let e=JSON.parse(l().readFileSync(r,"utf8"));return t.status(200).json(e)}catch{return t.status(200).json({heroImage:"",logo:""})}}if("POST"===e.method){if(!(e.cookies&&"1"===e.cookies.psp_admin||(e.headers.cookie||"").includes("psp_admin=1")))return t.status(401).json({error:"unauthorized"});let o=e.body;if("string"==typeof o)try{o=JSON.parse(o)}catch{}let n=process.env.SUPABASE_URL||"",i=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SUPABASE_ANON_KEY||"";if(n&&i){let e=(0,g.createClient)(n,i),r=[];if(Object.prototype.hasOwnProperty.call(o||{},"heroImage")&&r.push({key:"heroImage",value:String((o||{}).heroImage||"").trim()}),Object.prototype.hasOwnProperty.call(o||{},"logo")&&r.push({key:"logo",value:String((o||{}).logo||"").trim()}),r.length){let{error:o}=await e.from("site_config").upsert(r,{onConflict:"key"});if(o)return t.status(500).json({error:String(o.message||o)})}let{data:a}=await e.from("site_config").select("key,value").in("key",["heroImage","logo"]),s=Object.create(null)(a||[]).forEach(e=>{s[e.key]=e.value});return t.status(200).json({heroImage:String(s.heroImage||"").trim(),logo:String(s.logo||"").trim()})}let a={heroImage:"",logo:""};try{a=JSON.parse(l().readFileSync(r,"utf8"))}catch{}let s=Object.prototype.hasOwnProperty.call(o||{},"heroImage"),u=Object.prototype.hasOwnProperty.call(o||{},"logo"),p=s?String((o||{}).heroImage||"").trim():String(a.heroImage||""),f=u?String((o||{}).logo||"").trim():String(a.logo||""),m={heroImage:p,logo:f};try{l().mkdirSync(c().dirname(r),{recursive:!0})}catch{}return l().writeFileSync(r,JSON.stringify(m,null,2)),t.status(200).json(m)}return t.status(405).json({error:"Method not allowed"})}catch(e){t.status(500).json({error:String(e?.message||e)})}}let f=(0,a.l)(o,"default"),m=(0,a.l)(o,"config"),S=new n.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/site-config",pathname:"/api/site-config",bundlePath:"",filename:""},userland:o})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=4359);module.exports=r})();