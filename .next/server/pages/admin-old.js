(()=>{var e={};e.id=2200,e.ids=[2200,2888,660],e.modules={1323:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},1775:(e,t,i)=>{"use strict";i.r(t),i.d(t,{config:()=>v,default:()=>m,getServerSideProps:()=>j,getStaticPaths:()=>f,getStaticProps:()=>b,reportWebVitals:()=>S,routeModule:()=>R,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>k,unstable_getStaticParams:()=>T,unstable_getStaticPaths:()=>C,unstable_getStaticProps:()=>w});var s={};i.r(s),i.d(s,{default:()=>x,getServerSideProps:()=>y});var a=i(7093),l=i(5244),n=i(1323),r=i(1682),o=i.n(r),d=i(8269),c=i(997),p=i(6689),u=i(1664),g=i.n(u);function h({images:e,value:t,onChange:i,placeholder:s="选择图片路径...",width:a=360}){let[l,n]=(0,p.useState)(!1),[r,o]=(0,p.useState)(""),d=String(t||""),u=String(r||d||"");return(0,c.jsxs)("div",{style:{position:"relative",minWidth:a},children:[c.jsx("button",{type:"button",onClick:()=>n(!l),style:{width:"100%",textAlign:"left",padding:"6px 8px",border:"1px solid #e5e7eb",borderRadius:8,background:"#fff"},children:d||s}),l&&(0,c.jsxs)("div",{style:{position:"absolute",zIndex:100,top:"100%",left:0,display:"grid",gridTemplateColumns:"1fr 110px",gap:8,background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,marginTop:6,padding:8,boxShadow:"0 8px 20px rgba(0,0,0,0.08)"},children:[c.jsx("div",{style:{maxHeight:220,overflow:"auto",display:"grid",gap:6},children:e.map(e=>c.jsx("button",{type:"button",onMouseEnter:()=>o(e),onFocus:()=>o(e),onClick:()=>{i(e),n(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 8px",border:"1px solid #f3f4f6",background:d===e?"#eef":"#fff",borderRadius:6},children:e},e))}),c.jsx("div",{style:{width:110},children:u&&c.jsx("img",{src:u,alt:"预览",style:{width:"100%",height:100,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]})]})}function x(){let[e,t]=(0,p.useState)([]),[i,s]=(0,p.useState)([]),[a,l]=(0,p.useState)({heroImage:"",logo:""}),[n,r]=(0,p.useState)(""),[o,d]=(0,p.useState)(""),[u,x]=(0,p.useState)({}),[y,m]=(0,p.useState)({}),[b,f]=(0,p.useState)({}),[j,v]=(0,p.useState)({}),[S,w]=(0,p.useState)({}),[C,T]=(0,p.useState)(!1),[P,k]=(0,p.useState)(null),[R,N]=(0,p.useState)(""),[F,A]=(0,p.useState)([]),_=Math.max(1,...F.map(e=>Number(e.count||0))),[z,D]=(0,p.useState)([]),[E,O]=(0,p.useState)(""),[I,W]=(0,p.useState)(""),[B,M]=(0,p.useState)(""),[L,$]=(0,p.useState)("add-plant"),[J,q]=(0,p.useState)(""),[G,U]=(0,p.useState)(""),[H,V]=(0,p.useState)("Safe"),[K,X]=(0,p.useState)("Easy"),[Z,Q]=(0,p.useState)(""),[Y,ee]=(0,p.useState)(""),[et,ei]=(0,p.useState)(""),[es,ea]=(0,p.useState)(!1),el="#87A96B",en="#6B8553",er="#F5F1E8",eo="24px",ed="16px",[ec,ep]=(0,p.useState)([]),[eu,eg]=(0,p.useState)({}),eh=async(e,t)=>{try{await fetch("/api/admin/comments/moderate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,action:t})});let i=await fetch("/api/admin/comments/pending"),s=await i.json();D(s.comments||[]);let a=await fetch("/api/comments/list"),l=await a.json();ep(l.comments||[])}catch{}},ex=async e=>{let t=String((eu||{})[e]||"").trim();if(t)try{if((await fetch("/api/admin/comments/reply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,content:t})})).ok){eg(t=>({...t,[e]:""}));let t=await fetch("/api/comments/list"),i=await t.json();ep(i.comments||[])}}catch{}},ey=async e=>{if(e){T(!0);try{let i=new FileReader;i.onload=async()=>{let s=i.result,a=e.name.replace(/[^a-zA-Z0-9._-]/g,"_"),n=await fetch("/api/upload-base64",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:a,data:String(s||"")})});if(n.ok){let e=await n.json(),i=await (await fetch("/api/list-images")).json();return t(i.paths||[]),l(e=>({...e})),e?.path||""}T(!1)},i.readAsDataURL(e)}catch{T(!1)}}},em=async()=>{if(!P)return;let e=await ey(P);T(!1),e&&N("已上传到素材库"),k(null)},eb=async e=>{if(!e)return;await fetch("/api/site-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({heroImage:e})});let t=await (await fetch("/api/site-config")).json();l(t),r(t.heroImage||""),N("已应用到首页大图")},ef=async e=>{if(!e)return;await fetch("/api/site-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({logo:e})});let t=await (await fetch("/api/site-config")).json();l(t),d(t.logo||""),N("站点 Logo 已更新")},ej=async()=>{await eb(n),n&&window.open("/","_blank")},ev=async(e,t)=>{await fetch("/api/update-plant-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:e,imagePath:t})}),s((await (await fetch("/api/plants")).json()).plants||[]),x(i=>({...i,[e]:t})),N("已应用到该植物封面图")},eS=async(e,t)=>{await fetch("/api/update-plant-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:e,image2:t})}),s((await (await fetch("/api/plants")).json()).plants||[]),m(i=>({...i,[e]:t})),N("已应用到该植物附图 1")},ew=async(e,t)=>{await fetch("/api/update-plant-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:e,image3:t})}),s((await (await fetch("/api/plants")).json()).plants||[]),f(i=>({...i,[e]:t})),N("已应用到该植物附图 2")},eC=async(e,t,i)=>{let a={slug:e};"thumbPlant"===t&&(a.thumbPlant=i),"thumbCat"===t&&(a.thumbCat=i),await fetch("/api/update-plant-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),s((await (await fetch("/api/plants")).json()).plants||[]),"thumbPlant"===t&&v(t=>({...t,[e]:i})),"thumbCat"===t&&w(t=>({...t,[e]:i})),N("thumbCat"===t?"已应用到该植物猫咪缩略图":"已应用到该植物缩略图")};(0,p.useCallback)(async e=>{let t=u[e];await ev(e,t),e&&window.open(`/plants/${e}`,"_blank")},[u,ev]);let eT=async e=>{e.preventDefault(),ea(!0),ei("");let t=J.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-*|-*$/g,"");if(!t){ei("Error: Plant name cannot be empty."),ea(!1);return}try{let e=await fetch("/api/save-plant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:J,scientific_name:G,toxicity_level:H,care_difficulty:K,summary:Z,image:Y||`/images/plants/${t}.jpg`,slug:t})});if(e.ok){ei("Success: Plant added successfully!"),q(""),U(""),V("Safe"),X("Easy"),Q(""),ee("");let e=await (await fetch("/api/plants")).json();s(e.plants||[])}else{let t=await e.json();ei(`Error: ${t.error||"Failed to add plant."}`)}}catch(e){ei(`Error: ${e.message||"An unexpected error occurred."}`)}finally{ea(!1)}},eP=(0,p.useCallback)(async()=>{M("");try{let e=String(E||"").trim(),t=String(I||"").trim();if(e.length<2){M("Username must be at least 2 characters.");return}if(t.length<6){M("Password must be at least 6 characters.");return}let i=await fetch("/api/admin/credentials/set",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(i.ok)W(""),M("Admin account updated, please log out and log in with the new account.");else{let e=await i.json().catch(()=>({}));M(String(e.error||"Update failed."))}}catch{M("Update failed.")}},[E,I]);return(0,c.jsxs)("div",{style:{padding:20},children:[c.jsx("h1",{children:"后台"}),c.jsx("p",{children:c.jsx(g(),{href:"/",children:"← 返回首页"})}),R&&c.jsx("div",{style:{margin:"8px 0",color:"#2e7d32"},children:R}),c.jsx("form",{onSubmit:async e=>{e.preventDefault(),await fetch("/api/auth/logout",{method:"POST"}),window.location.href="/login"},children:c.jsx("button",{type:"submit",style:{marginTop:8},children:"退出登录"})}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,marginTop:16},children:[c.jsx("button",{type:"button",onClick:()=>$("images"),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"images"===L?"#eef":"#fff"},children:"图片管理"}),c.jsx("button",{type:"button",onClick:()=>$("stats"),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"stats"===L?"#eef":"#fff"},children:"数据统计"}),c.jsx("button",{type:"button",onClick:()=>$("comments"),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"comments"===L?"#eef":"#fff"},children:"评论管理"}),c.jsx("button",{type:"button",onClick:()=>$("tables"),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"tables"===L?"#eef":"#fff"},children:"数据表"}),c.jsx("button",{type:"button",onClick:()=>$("add-plant"),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e5e7eb",background:"add-plant"===L?"#eef":"#fff"},children:"添加植物"})]}),"images"===L&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("section",{style:{marginTop:20},children:[c.jsx("h2",{children:"上传文件"}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx("input",{type:"file",accept:"image/*",onChange:e=>k(e.target.files?.[0]||null)}),c.jsx("button",{type:"button",onClick:em,disabled:!P||C,children:C?"上传中...":"确认上传"})]}),c.jsx("div",{style:{marginTop:6,fontSize:12,color:"#555"},children:"上传后会出现在下方下拉列表中，选择对应图位并点击应用。"})]}),(0,c.jsxs)("section",{style:{marginTop:20},children:[c.jsx("h2",{children:"首页大图（Hero）"}),(0,c.jsxs)("p",{children:["当前：",c.jsx("code",{children:a?.heroImage||"未设置"})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx(h,{images:e,value:n||a.heroImage||"",onChange:e=>r(e),placeholder:"选择图片路径...",width:420}),c.jsx("button",{type:"button",onClick:()=>eb(n||a.heroImage||""),disabled:!(n||a.heroImage),style:{padding:"6px 10px"},children:"应用"}),c.jsx("button",{type:"button",onClick:ej,disabled:!n,style:{padding:"6px 10px"},children:"应用并预览"}),c.jsx("div",{style:{width:110},children:(n||a.heroImage)&&c.jsx("img",{src:n||a.heroImage,alt:"预览",style:{width:"100%",height:60,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]})]}),(0,c.jsxs)("section",{style:{marginTop:12},children:[c.jsx("h2",{children:"站点 Logo"}),(0,c.jsxs)("p",{children:["当前：",c.jsx("code",{children:a?.logo||"未设置"})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx(h,{images:e,value:o||a.logo||"",onChange:e=>d(e),placeholder:"选择图片路径...",width:420}),c.jsx("button",{type:"button",onClick:()=>ef(o||a.logo||""),disabled:!(o||a.logo),style:{padding:"6px 10px"},children:"应用"}),c.jsx("div",{style:{width:110},children:(o||a.logo)&&c.jsx("img",{src:o||a.logo,alt:"预览",style:{width:"100%",height:60,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]}),c.jsx("div",{style:{marginTop:6,fontSize:12,color:"#555"},children:"建议使用透明背景的 PNG/SVG，系统会自动适配页面底色显示。"})]}),(0,c.jsxs)("section",{style:{marginTop:24},children:[c.jsx("h2",{children:"植物图片（详情页封面）"}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:i.map(t=>(0,c.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[c.jsx("div",{style:{fontWeight:600},children:t.title||t.slug}),(0,c.jsxs)("div",{style:{fontSize:12,color:"#555"},children:["当前图片：",c.jsx("code",{children:t.image||"未设置"})]}),(0,c.jsxs)("div",{style:{fontSize:12,color:"#555",marginTop:4},children:["附图1：",c.jsx("code",{children:t.image2||"未设置"})," ／ 附图2：",c.jsx("code",{children:t.image3||"未设置"})]}),c.jsx("div",{style:{marginTop:6},children:(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx(h,{images:e,value:u[t.slug]??(t.image||""),onChange:e=>x(i=>({...i,[t.slug]:e})),placeholder:"选择图片路径...",width:420}),c.jsx("button",{type:"button",onClick:()=>ev(t.slug,u[t.slug]??(t.image||"")),disabled:!(u[t.slug]??(t.image||"")),style:{padding:"6px 10px"},children:"应用"}),c.jsx("div",{style:{width:110},children:(u[t.slug]??(t.image||""))&&c.jsx("img",{src:u[t.slug]??(t.image||""),alt:"预览",style:{width:"100%",height:60,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]})}),c.jsx("div",{style:{marginTop:10},children:(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx(h,{images:e,value:y[t.slug]??(t.image2||""),onChange:e=>m(i=>({...i,[t.slug]:e})),placeholder:"选择图片路径...",width:420}),c.jsx("button",{type:"button",onClick:()=>eS(t.slug,y[t.slug]??(t.image2||"")),disabled:!(y[t.slug]??(t.image2||"")),style:{padding:"6px 10px"},children:"应用"}),c.jsx("div",{style:{width:110},children:(y[t.slug]??(t.image2||""))&&c.jsx("img",{src:y[t.slug]??(t.image2||""),alt:"预览",style:{width:"100%",height:60,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]})}),c.jsx("div",{style:{marginTop:10},children:(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx(h,{images:e,value:b[t.slug]??(t.image3||""),onChange:e=>f(i=>({...i,[t.slug]:e})),placeholder:"选择图片路径...",width:420}),c.jsx("button",{type:"button",onClick:()=>ew(t.slug,b[t.slug]??(t.image3||"")),disabled:!(b[t.slug]??(t.image3||"")),style:{padding:"6px 10px"},children:"应用"}),c.jsx("div",{style:{width:110},children:(b[t.slug]??(t.image3||""))&&c.jsx("img",{src:b[t.slug]??(t.image3||""),alt:"预览",style:{width:"100%",height:60,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]})}),(0,c.jsxs)("div",{style:{marginTop:12,borderTop:"1px dashed #e5e7eb",paddingTop:10},children:[(0,c.jsxs)("div",{style:{fontSize:12,color:"#555",marginBottom:6},children:["当前缩略图：",c.jsx("code",{children:t.thumbPlant||"未设置"})," ／ 猫咪缩略图：",c.jsx("code",{children:t.thumbCat||"未设置"})]}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx(h,{images:e,value:j[t.slug]??(t.thumbPlant||""),onChange:e=>v(i=>({...i,[t.slug]:e})),placeholder:"选择图片路径...",width:420}),c.jsx("button",{type:"button",onClick:()=>eC(t.slug,"thumbPlant",j[t.slug]??(t.thumbPlant||"")),disabled:!(j[t.slug]??(t.thumbPlant||"")),style:{padding:"6px 10px"},children:"应用"}),c.jsx("div",{style:{width:110},children:(j[t.slug]??(t.thumbPlant||""))&&c.jsx("img",{src:j[t.slug]??(t.thumbPlant||""),alt:"预览",style:{width:"100%",height:60,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx(h,{images:e,value:S[t.slug]??(t.thumbCat||""),onChange:e=>w(i=>({...i,[t.slug]:e})),placeholder:"选择图片路径...",width:420}),c.jsx("button",{type:"button",onClick:()=>eC(t.slug,"thumbCat",S[t.slug]??(t.thumbCat||"")),disabled:!(S[t.slug]??(t.thumbCat||"")),style:{padding:"6px 10px"},children:"应用"}),c.jsx("div",{style:{width:110},children:(S[t.slug]??(t.thumbCat||""))&&c.jsx("img",{src:S[t.slug]??(t.thumbCat||""),alt:"预览",style:{width:"100%",height:60,objectFit:"cover",borderRadius:6,border:"1px solid #e5e7eb"}})})]})]})]})]},t.slug))})]})]}),"stats"===L&&(0,c.jsxs)("section",{style:{marginTop:24},children:[c.jsx("h2",{children:"数据统计（30天）"}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:(0,c.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[c.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"每日访问次数"}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:6},children:F.map(e=>(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"110px 1fr 54px",alignItems:"center",gap:8},children:[c.jsx("span",{style:{color:"#555"},children:e.date}),c.jsx("div",{style:{background:"#f3f4f6",borderRadius:999,overflow:"hidden",height:10},children:c.jsx("div",{style:{width:`${Math.max(2,Math.round(Number(e.count||0)/_*100))}%`,height:"100%",background:"linear-gradient(90deg, #A8E6CF, #FFD3B6, #DCBFFF)"}})}),c.jsx("span",{style:{fontWeight:600,textAlign:"right"},children:e.count})]},e.date))})]})})]}),"comments"===L&&(0,c.jsxs)("section",{style:{marginTop:24},children:[c.jsx("h2",{children:"评论管理"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,c.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[c.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"待审核"}),(0,c.jsxs)("div",{style:{display:"grid",gap:10},children:[0===z.length&&c.jsx("div",{style:{color:"#777"},children:"暂无待审核评论"}),z.map(e=>(0,c.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[(0,c.jsxs)("div",{style:{fontSize:12,color:"#555"},children:[e.slug," • ",e.author||"Anonymous"," • ",new Date(e.created_at).toLocaleString()]}),c.jsx("div",{style:{marginTop:6},children:e.content}),(0,c.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[c.jsx("button",{type:"button",onClick:()=>eh(e.id,"approve"),children:"通过"}),c.jsx("button",{type:"button",onClick:()=>eh(e.id,"delete"),children:"删除"})]})]},e.id))]})]}),(0,c.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[c.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"已审核"}),(0,c.jsxs)("div",{style:{display:"grid",gap:10},children:[0===ec.length&&c.jsx("div",{style:{color:"#777"},children:"暂无已审核评论"}),ec.map(e=>(0,c.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[(0,c.jsxs)("div",{style:{fontSize:12,color:"#555"},children:[e.slug," • ",e.author||"Anonymous"," • ",new Date(e.created_at).toLocaleString()]}),c.jsx("div",{style:{marginTop:6},children:e.content}),Array.isArray(e.replies)&&e.replies.length>0&&c.jsx("div",{style:{marginTop:8,display:"grid",gap:6},children:e.replies.map(e=>(0,c.jsxs)("div",{style:{border:"1px dashed #e5e7eb",borderRadius:8,padding:8},children:[(0,c.jsxs)("div",{style:{fontSize:12,color:"#555"},children:[e.author||"Admin"," • ",new Date(e.created_at).toLocaleString()]}),c.jsx("div",{style:{marginTop:4},children:e.content})]},e.id))}),(0,c.jsxs)("div",{style:{display:"grid",gap:6,marginTop:8},children:[c.jsx("textarea",{rows:2,placeholder:"回复内容...",value:String((eu||{})[e.id]||""),onChange:t=>eg(i=>({...i,[e.id]:t.target.value}))}),(0,c.jsxs)("div",{style:{display:"flex",gap:8},children:[c.jsx("button",{type:"button",onClick:()=>ex(e.id),disabled:!String((eu||{})[e.id]||"").trim(),children:"回复"}),c.jsx("button",{type:"button",onClick:()=>eh(e.id,"delete"),children:"删除"})]})]})]},e.id))]})]})]})]}),"tables"===L&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("section",{style:{marginTop:24},children:[c.jsx("h2",{children:"数据表"}),c.jsx("div",{style:{color:"#555",marginBottom:8},children:"用户管理（待开发）"}),c.jsx("div",{style:{color:"#555"},children:"更多数据类管理项可在此扩展。"})]}),(0,c.jsxs)("section",{style:{marginTop:24},children:[c.jsx("h2",{children:"后台账号设置"}),(0,c.jsxs)("div",{style:{display:"grid",gap:10,maxWidth:420},children:[(0,c.jsxs)("label",{style:{display:"grid",gap:6},children:[c.jsx("span",{children:"用户名"}),c.jsx("input",{value:E,onChange:e=>O(e.target.value),placeholder:"",autoComplete:"off",inputMode:"text",spellCheck:!1,autoCapitalize:"none",onKeyDown:e=>{"Enter"===e.key&&eP()}})]}),(0,c.jsxs)("label",{style:{display:"grid",gap:6},children:[c.jsx("span",{children:"新密码"}),c.jsx("input",{type:"password",value:I,onChange:e=>W(e.target.value),placeholder:"",autoComplete:"new-password",spellCheck:!1,onKeyDown:e=>{"Enter"===e.key&&eP()}})]}),c.jsx("button",{type:"button",onClick:eP,disabled:!E||!I,children:"更新后台账号"}),c.jsx("div",{style:{color:"#666"},children:"更新后请退出并用新账号登录。"}),B&&c.jsx("div",{style:{color:B.includes("已更新")?"#2e7d32":"#c62828"},children:B})]})]})]}),"add-plant"===L&&(0,c.jsxs)("section",{style:{marginTop:24,background:"#FAF7F2",borderRadius:eo,padding:"32px",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08)",border:`2px solid ${er}`},children:[c.jsx("h2",{style:{fontSize:"28px",fontWeight:700,color:en,marginBottom:"24px"},children:"Add New Plant"}),(0,c.jsxs)("form",{onSubmit:eT,style:{display:"grid",gap:"20px",maxWidth:"600px"},children:[(0,c.jsxs)("label",{style:{display:"grid",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:600,color:en,fontSize:"15px"},children:"Plant Name:"}),c.jsx("input",{type:"text",value:J,onChange:e=>q(e.target.value),required:!0,style:{padding:"12px 16px",borderRadius:ed,border:`2px solid ${er}`,fontSize:"15px",outline:"none",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor=el},onBlur:e=>{e.currentTarget.style.borderColor=er}})]}),(0,c.jsxs)("label",{style:{display:"grid",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:600,color:en,fontSize:"15px"},children:"Scientific Name:"}),c.jsx("input",{type:"text",value:G,onChange:e=>U(e.target.value),style:{padding:"12px 16px",borderRadius:ed,border:`2px solid ${er}`,fontSize:"15px",outline:"none",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor=el},onBlur:e=>{e.currentTarget.style.borderColor=er}})]}),(0,c.jsxs)("label",{style:{display:"grid",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:600,color:en,fontSize:"15px"},children:"Toxicity Level:"}),(0,c.jsxs)("select",{value:H,onChange:e=>V(e.target.value),required:!0,style:{padding:"12px 16px",borderRadius:ed,border:`2px solid ${er}`,fontSize:"15px",background:"#fff",outline:"none",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor=el},onBlur:e=>{e.currentTarget.style.borderColor=er},children:[c.jsx("option",{value:"Safe",children:"Safe"}),c.jsx("option",{value:"Caution",children:"Caution"}),c.jsx("option",{value:"Toxic",children:"Toxic"})]})]}),(0,c.jsxs)("label",{style:{display:"grid",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:600,color:en,fontSize:"15px"},children:"Care Difficulty:"}),(0,c.jsxs)("select",{value:K,onChange:e=>X(e.target.value),required:!0,style:{padding:"12px 16px",borderRadius:ed,border:`2px solid ${er}`,fontSize:"15px",background:"#fff",outline:"none",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor=el},onBlur:e=>{e.currentTarget.style.borderColor=er},children:[c.jsx("option",{value:"Easy",children:"Easy"}),c.jsx("option",{value:"Medium",children:"Medium"}),c.jsx("option",{value:"Hard",children:"Hard"})]})]}),(0,c.jsxs)("label",{style:{display:"grid",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:600,color:en,fontSize:"15px"},children:"English Description:"}),c.jsx("textarea",{value:Z,onChange:e=>Q(e.target.value),required:!0,rows:6,style:{padding:"12px 16px",borderRadius:ed,border:`2px solid ${er}`,fontSize:"15px",fontFamily:"inherit",resize:"vertical",outline:"none",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor=el},onBlur:e=>{e.currentTarget.style.borderColor=er}})]}),(0,c.jsxs)("label",{style:{display:"grid",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:600,color:en,fontSize:"15px"},children:"Image URL (e.g., /images/plants/my-plant.jpg):"}),c.jsx("input",{type:"text",value:Y,onChange:e=>ee(e.target.value),placeholder:"/images/plants/my-plant.jpg",style:{padding:"12px 16px",borderRadius:ed,border:`2px solid ${er}`,fontSize:"15px",outline:"none",transition:"all 0.3s ease"},onFocus:e=>{e.currentTarget.style.borderColor=el},onBlur:e=>{e.currentTarget.style.borderColor=er}})]}),c.jsx("button",{type:"submit",disabled:es,style:{padding:"14px 24px",background:es?"#ccc":el,color:"#fff",border:"none",borderRadius:eo,fontWeight:600,fontSize:"16px",cursor:es?"not-allowed":"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{es||(e.currentTarget.style.background=en)},onMouseLeave:e=>{es||(e.currentTarget.style.background=el)},children:es?"Submitting...":"Add Plant"}),et&&c.jsx("div",{style:{marginTop:"10px",padding:"12px",borderRadius:ed,background:et.includes("Success")?"#D4EDDA":"#F8D7DA",color:et.includes("Success")?"#155724":"#721C24",border:`1px solid ${et.includes("Success")?"#C3E6CB":"#F5C6CB"}`},children:et})]})]})]})}async function y({req:e}){return(e.headers.cookie||"").includes("psp_admin=1")?{props:{}}:{redirect:{destination:"/login",permanent:!1}}}let m=(0,n.l)(s,"default"),b=(0,n.l)(s,"getStaticProps"),f=(0,n.l)(s,"getStaticPaths"),j=(0,n.l)(s,"getServerSideProps"),v=(0,n.l)(s,"config"),S=(0,n.l)(s,"reportWebVitals"),w=(0,n.l)(s,"unstable_getStaticProps"),C=(0,n.l)(s,"unstable_getStaticPaths"),T=(0,n.l)(s,"unstable_getStaticParams"),P=(0,n.l)(s,"unstable_getServerProps"),k=(0,n.l)(s,"unstable_getServerSideProps"),R=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin-old",pathname:"/admin-old",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:s})},8269:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var s=i(997);i(6764);var a=i(1664),l=i.n(a),n=i(6689);function r({Component:e,pageProps:t}){let[i,a]=(0,n.useState)(""),[r,o]=(0,n.useState)([]),[d,c]=(0,n.useState)([]),[p,u]=(0,n.useState)([]),[g,h]=(0,n.useState)([]),[x,y]=(0,n.useState)({safe:!1,toxic:!1,caution:!1}),[m,b]=(0,n.useState)(!1),[f,j]=(0,n.useState)(""),v=async()=>{try{let e=await fetch("/api/plants"),t=((await e.json()).plants||[]).map(e=>({slug:e.slug,title:String(e.title||""),scientific_name:String(e.scientific_name||""),toxicity_level:String(e.toxicity_level||"")})),s=i.trim().toLowerCase();if(!s)return;let a=t.filter(e=>e.title.toLowerCase().includes(s)||e.scientific_name.toLowerCase().includes(s)||e.slug.toLowerCase().includes(s))[0];a&&(window.location.href="/plants/"+a.slug)}catch{}},S=e=>{y(t=>({...t,[e]:!t[e]}))};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("header",{className:"header",children:[(0,s.jsxs)("div",{className:"header-inner",children:[f?(0,s.jsxs)(l(),{href:"/",className:"logo",children:[s.jsx("img",{src:f,alt:"PawSafePlants",style:{height:72,width:"auto",display:"block",mixBlendMode:"screen",position:"relative",zIndex:2}}),s.jsx("span",{style:{marginLeft:-14,fontWeight:800,fontSize:22,color:"#fff",position:"relative",zIndex:1,textShadow:"0 1px 2px rgba(0,0,0,0.35)"},children:"PawSafePlants"})]}):s.jsx(l(),{href:"/",className:"logo",style:{fontWeight:700,fontSize:20},children:"\uD83D\uDC3E PawSafePlants"}),(0,s.jsxs)("div",{className:"search-box",children:[s.jsx("input",{id:"global-search-input",type:"text",placeholder:"Search plants by name or scientific name...",value:i,onChange:e=>a(e.target.value)}),s.jsx("button",{type:"button",onClick:v,"aria-label":"Search",children:(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[s.jsx("circle",{cx:"11",cy:"11",r:"7",stroke:"#fff",strokeWidth:"2"}),s.jsx("path",{d:"M20 20l-3-3",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round"})]})})]})]}),(0,s.jsxs)("nav",{className:"nav-menu",children:[(0,s.jsxs)("div",{className:"nav-item-wrapper",onMouseEnter:()=>{m||y(e=>({...e,safe:!0}))},onMouseLeave:()=>{m||y(e=>({...e,safe:!1}))},children:[s.jsx(l(),{href:"/plants/safe",className:"nav-item",onClick:e=>{m&&(e.preventDefault(),S("safe"))},children:"Cat-Safe Plants \uD83C\uDF38"}),x.safe&&s.jsx("div",{className:"dropdown",children:d.map(e=>s.jsx(l(),{href:`/plants/${e.slug}`,className:"dropdown-item",children:e.title||e.slug},e.slug))})]}),(0,s.jsxs)("div",{className:"nav-item-wrapper",onMouseEnter:()=>{m||y(e=>({...e,toxic:!0}))},onMouseLeave:()=>{m||y(e=>({...e,toxic:!1}))},children:[s.jsx(l(),{href:"/plants/toxic",className:"nav-item",onClick:e=>{m&&(e.preventDefault(),S("toxic"))},children:"Toxic Plants \uD83D\uDEAB"}),x.toxic&&s.jsx("div",{className:"dropdown",children:p.map(e=>s.jsx(l(),{href:`/plants/${e.slug}`,className:"dropdown-item",children:e.title||e.slug},e.slug))})]}),(0,s.jsxs)("div",{className:"nav-item-wrapper",onMouseEnter:()=>{m||y(e=>({...e,caution:!0}))},onMouseLeave:()=>{m||y(e=>({...e,caution:!1}))},children:[s.jsx(l(),{href:"/plants/caution",className:"nav-item",onClick:e=>{m&&(e.preventDefault(),S("caution"))},children:"Moderate Risk ⚠️"}),x.caution&&s.jsx("div",{className:"dropdown",children:g.map(e=>s.jsx(l(),{href:`/plants/${e.slug}`,className:"dropdown-item",children:e.title||e.slug},e.slug))})]}),s.jsx(l(),{href:"/items",className:"nav-item",children:"More Products \uD83C\uDF80"})]})]}),s.jsx(e,{...t})]})}},6764:()=>{},5244:(e,t)=>{"use strict";var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},1017:e=>{"use strict";e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),s=t.X(0,[9013,1682,1664],()=>i(1775));module.exports=s})();