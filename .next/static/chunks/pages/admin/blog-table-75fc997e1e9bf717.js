(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[810],{3274:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/blog-table",function(){return o(5119)}])},5119:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return p}});var n=o(5893),r=o(7294),i=o(1163),l=o(9008),s=o.n(l),d=o(1664),a=o.n(d);function p(){let e=(0,i.useRouter)(),[t,o]=(0,r.useState)(""),[l,d]=(0,r.useState)([]),[p,x]=(0,r.useState)([]),[c,h]=(0,r.useState)(!0),[u,f]=(0,r.useState)(""),[g,b]=(0,r.useState)("created_at"),[y,j]=(0,r.useState)("desc"),[m,S]=(0,r.useState)(1),[w]=(0,r.useState)(10);(0,r.useEffect)(()=>{let t=localStorage.getItem("admin_token");if(!t){e.push("/admin");return}o(t),v(t)},[]),(0,r.useEffect)(()=>{let e=l;u&&(e=e.filter(e=>e.title.toLowerCase().includes(u.toLowerCase())||e.excerpt&&e.excerpt.toLowerCase().includes(u.toLowerCase())||e.tags&&e.tags.some(e=>e.toLowerCase().includes(u.toLowerCase())))),e.sort((e,t)=>{let o=e[g],n=t[g];return(("created_at"===g||"updated_at"===g)&&(o=new Date(o),n=new Date(n)),"asc"===y)?o>n?1:-1:o<n?1:-1}),x(e),S(1)},[l,u,g,y]);let v=async e=>{try{let t=await fetch("/api/admin/blog-list",{headers:{Authorization:"Bearer ".concat(e)}}),o=await t.json();o.success&&d(o.data||[])}catch(e){console.error("获取博客列表失败:",e)}finally{h(!1)}},k=async e=>{if(confirm("确定要删除这篇博客吗？此操作不可恢复。"))try{let o=await fetch("/api/admin/blog-list?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),n=await o.json();n.success?(alert("博客删除成功"),v(t)):alert("删除失败: ".concat(n.error))}catch(e){console.error("删除失败:",e),alert("删除失败，请重试")}},z=e=>new Date(e).toLocaleString("zh-CN"),C=e=>{let t={published:{bg:"#10b981",text:"已发布"},draft:{bg:"#6b7280",text:"草稿"},archived:{bg:"#ef4444",text:"已归档"}},o=t[e]||t.draft;return(0,n.jsx)("span",{style:{display:"inline-block",padding:"4px 8px",backgroundColor:o.bg,color:"white",fontSize:"12px",borderRadius:"4px",fontWeight:"500"},children:o.text})},D=e=>e?(0,n.jsx)("span",{style:{display:"inline-block",padding:"4px 8px",backgroundColor:"#f59e0b",color:"white",fontSize:"12px",borderRadius:"4px",fontWeight:"500",marginLeft:"4px"},children:"精选"}):null,_=m*w,R=p.slice(_-w,_),W=Math.ceil(p.length/w),B=e=>S(e);return c?(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"加载中..."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s(),{children:[(0,n.jsx)("title",{children:"博客管理 - PawSafePlants"}),(0,n.jsx)("meta",{name:"description",content:"博客列表管理"})]}),(0,n.jsxs)("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif"},children:[(0,n.jsxs)("div",{style:{marginBottom:"30px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{style:{fontSize:"32px",fontWeight:"600",color:"#2d3748",marginBottom:"8px"},children:"\uD83D\uDCDD 博客管理"}),(0,n.jsxs)("p",{style:{color:"#718096",fontSize:"16px"},children:["共 ",p.length," 篇博客"]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,n.jsx)(a(),{href:"/admin/blog-editor",children:(0,n.jsx)("button",{style:{padding:"12px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s"},children:"➕ 新建博客"})}),(0,n.jsx)(a(),{href:"/admin",children:(0,n.jsx)("button",{style:{padding:"12px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s"},children:"\uD83C\uDFE0 返回后台"})})]})]}),(0,n.jsx)("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"20px",marginBottom:"30px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07)",border:"1px solid #e2e8f0"},children:(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"16px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#4a5568",marginBottom:"8px"},children:"\uD83D\uDD0D 搜索博客"}),(0,n.jsx)("input",{type:"text",value:u,onChange:e=>f(e.target.value),placeholder:"搜索标题、摘要或标签...",style:{width:"100%",padding:"10px 12px",border:"2px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",outline:"none",transition:"border-color 0.2s"},onFocus:e=>{e.target.style.borderColor="#4299e1"},onBlur:e=>{e.target.style.borderColor="#e2e8f0"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#4a5568",marginBottom:"8px"},children:"\uD83D\uDCCA 排序字段"}),(0,n.jsxs)("select",{value:g,onChange:e=>b(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",outline:"none",transition:"border-color 0.2s"},children:[(0,n.jsx)("option",{value:"created_at",children:"创建时间"}),(0,n.jsx)("option",{value:"updated_at",children:"更新时间"}),(0,n.jsx)("option",{value:"title",children:"标题"}),(0,n.jsx)("option",{value:"status",children:"状态"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#4a5568",marginBottom:"8px"},children:"⬆️ 排序方向"}),(0,n.jsxs)("select",{value:y,onChange:e=>j(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",outline:"none",transition:"border-color 0.2s"},children:[(0,n.jsx)("option",{value:"desc",children:"降序"}),(0,n.jsx)("option",{value:"asc",children:"升序"})]})]})]})}),(0,n.jsx)("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"20px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07)",border:"1px solid #e2e8f0"},children:0===R.length?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"60px 20px",color:"#718096"},children:[(0,n.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83D\uDCDD"}),(0,n.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"8px"},children:u?"没有找到匹配的博客":"还没有发布任何博客"}),(0,n.jsx)("p",{style:{fontSize:"16px"},children:u?"尝试调整搜索条件":"开始发布您的第一篇博客吧！"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{overflowX:"auto"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{style:{borderBottom:"2px solid #e2e8f0"},children:[(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:"600",color:"#4a5568",fontSize:"13px",textTransform:"uppercase"},children:"博客信息"}),(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:"600",color:"#4a5568",fontSize:"13px",textTransform:"uppercase"},children:"状态"}),(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:"600",color:"#4a5568",fontSize:"13px",textTransform:"uppercase"},children:"图片槽位"}),(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:"600",color:"#4a5568",fontSize:"13px",textTransform:"uppercase"},children:"更新时间"}),(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:"600",color:"#4a5568",fontSize:"13px",textTransform:"uppercase"},children:"操作"})]})}),(0,n.jsx)("tbody",{children:R.map(e=>(0,n.jsxs)("tr",{style:{borderBottom:"1px solid #f1f5f9",transition:"background-color 0.2s"},children:[(0,n.jsx)("td",{style:{padding:"16px 8px"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.cover_image_url&&(0,n.jsx)("img",{src:e.cover_image_url,alt:e.title,style:{width:"60px",height:"40px",objectFit:"cover",borderRadius:"6px",border:"1px solid #e2e8f0"}}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)("div",{style:{fontWeight:"600",color:"#2d3748",marginBottom:"4px",fontSize:"15px"},children:e.title}),e.excerpt&&(0,n.jsx)("div",{style:{color:"#718096",fontSize:"13px",lineHeight:"1.4",marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.excerpt}),e.slug&&(0,n.jsxs)("div",{style:{color:"#4299e1",fontSize:"12px",fontFamily:"monospace"},children:["/blog/",e.slug]})]})]})}),(0,n.jsx)("td",{style:{padding:"16px 8px"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[C(e.status),D(e.featured)]})}),(0,n.jsx)("td",{style:{padding:"16px 8px"},children:e.image_slots&&Object.keys(e.image_slots).length>0?(0,n.jsx)("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:Object.keys(e.image_slots).map((e,t)=>(0,n.jsx)("span",{style:{display:"inline-block",padding:"2px 6px",backgroundColor:"#edf2f7",color:"#4a5568",fontSize:"11px",borderRadius:"3px",border:"1px solid #e2e8f0"},title:e,children:e.replace(/_/g," ")},e))}):(0,n.jsx)("span",{style:{color:"#cbd5e0",fontSize:"12px"},children:"无图片槽位"})}),(0,n.jsx)("td",{style:{padding:"16px 8px"},children:(0,n.jsx)("div",{style:{color:"#718096",fontSize:"13px"},children:z(e.updated_at)})}),(0,n.jsx)("td",{style:{padding:"16px 8px"},children:(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[(0,n.jsx)(a(),{href:"/admin/blog-editor?id=".concat(e.id),children:(0,n.jsx)("button",{style:{padding:"6px 12px",background:"#4299e1",color:"white",border:"none",borderRadius:"4px",fontSize:"12px",cursor:"pointer",transition:"background-color 0.2s"},children:"✏️ 编辑"})}),(0,n.jsx)(a(),{href:"/blog/".concat(e.slug),target:"_blank",children:(0,n.jsx)("button",{style:{padding:"6px 12px",background:"#10b981",color:"white",border:"none",borderRadius:"4px",fontSize:"12px",cursor:"pointer",transition:"background-color 0.2s"},children:"\uD83D\uDC41️ 查看"})}),(0,n.jsx)("button",{onClick:()=>k(e.id),style:{padding:"6px 12px",background:"#ef4444",color:"white",border:"none",borderRadius:"4px",fontSize:"12px",cursor:"pointer",transition:"background-color 0.2s"},children:"\uD83D\uDDD1️ 删除"})]})})]},e.id))})]})}),W>1&&(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px",gap:"8px"},children:[(0,n.jsx)("button",{onClick:()=>B(m-1),disabled:1===m,style:{padding:"8px 12px",background:1===m?"#e2e8f0":"#4299e1",color:1===m?"#a0aec0":"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:1===m?"not-allowed":"pointer"},children:"上一页"}),Array.from({length:W},(e,t)=>t+1).map(e=>(0,n.jsx)("button",{onClick:()=>B(e),style:{padding:"8px 12px",background:m===e?"#4299e1":"#e2e8f0",color:m===e?"white":"#4a5568",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:e},e)),(0,n.jsx)("button",{onClick:()=>B(m+1),disabled:m===W,style:{padding:"8px 12px",background:m===W?"#e2e8f0":"#4299e1",color:m===W?"#a0aec0":"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:m===W?"not-allowed":"pointer"},children:"下一页"})]})]})})]})]})}},1163:function(e,t,o){e.exports=o(6036)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=3274)}),_N_E=e.O()}]);